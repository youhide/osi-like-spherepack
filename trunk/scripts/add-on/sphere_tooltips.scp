//****************************************************************************
// SphereServer ï¿½1997-2009
// This script is part from the Sphere Community Script Pack.
// You can download the full pack from: www.sphereserver.net
//****************************************************************************
// FILE LAST UPDATED:
VERSION=0.56b
//
// SCRIPT CREDITS
// --------------
// ShiryuX - All the script
//
// SCRIPT DOCUMENTATION
// --------------------
// New tooltips generation, experimental for now.
// Only tested on t_armor.

[events e_PlayerTooltipEvent]
on=@itemclienttooltip
IF <ACT.TYPE> == T_SPAWN_CHAR
 RETURN 0
ENDIF

IF <ACT.dTAG.DONATOR>
 ACT.ATTR ATTR_NEWBIE
ENDIF

IF <ACT.TYPE> == T_CORPSE
 ADDCLILOC 1042971,<ACT.NAME>
ELSE
 ADDCLILOC 1042971,<QVAL <ACT.AMOUNT>=1?<ACT.NAME>:<ACT.AMOUNT> <ACT.NAME>>
ENDIF

IF <ACT.ISEVENT.T_ITEM_INSURED>
 ADDCLILOC 1061682
ENDIF

IF STRMATCH(I_SKULL*,<ACT.BASEID>)
 IF STRMATCH(*POWER,<ACT.BASEID>)
  ADDCLILOC 1060401,+10
  ADDCLILOC 1060485,+8
 ENDIF
 RETURN 1
ENDIF

IF <ACT.dTAG.SKULLENHANCED>
 IF <ACT.dTAG.SKULLENHANCED> == 1
  LOCAL.SKULL Power
 ELIF ACT.dTAG.SKULLENHANCED> == 2
  LOCAL.SKULL Greed
 ENDIF
ENDIF

IF <ACT.dTAG.CURSED>
 ADDCLILOC 1049643
ENDIF

IF (<ACT.ATTR> & ATTR_NEWBIE) || ( !<ISNUM <LOCAL.SKULL>> && STRMATCH(*,<LOCAL.SKULL>) )
 LOCAL.CLILOC "EMPTY "
 IF (<ACT.ATTR> & ATTR_NEWBIE)
  LOCAL.CLILOC .= "<DEF.BFONT_LGRAY>Blessed<DEF.BFONT_WHITE>"
 ENDIF
 IF !<ISNUM <LOCAL.SKULL>> && STRMATCH(*,<LOCAL.SKULL>)
  IF STRMATCH(EMPTY,<LOCAL.CLILOC>)
   LOCAL.CLILOC .= "[<DEF.BFONT_LPURPLE><LOCAL.SKULL><DEF.BFONT_WHITE>]"
  ELSE
   LOCAL.CLILOC .= "<DEF.BR>[<DEF.BFONT_LPURPLE><LOCAL.SKULL><DEF.BFONT_WHITE>]"
  ENDIF
 ENDIF
 ADDCLILOC 1070722,<STREAT <LOCAL.CLILOC>>
ENDIF

IF <ACT.dTAG.DONATOR>
 ADDCLILOC 1049644,<DEF.BFONT_LGREEN>Donator Reward<DEF.BFONT_WHITE>
ENDIF

IF <ACT.TAG0.SETID> > 0
 ADDCLILOC 1072376,<DEF.SET_<ACT.TAG0.SETID>_PIECES>
ENDIF

IF <ACT.TAG0.EXCEPTIONAL>
 ADDCLILOC 1018303
ENDIF

IF !<ISNUM <ACT.TAG0.CRAFTEDBY>>
 ADDCLILOC 1050043,<ACT.TAG0.CRAFTEDBY> // crafted by ~1_NAME~
ENDIF

IF <ACT.TYPE> == T_CONTAINER
 IF <ACT.ISEVENT.T_LOCKED_DOWN>
  ADDCLILOC <QVAL (<ACT.TAG0.ACCESS>==0)?501643:501644>
  IF <ACT.dTAG0.ACCESS> >= 2
   ADDCLILOC <EVAL 1061281 - <ACT.dTAG0.ACCESS>>
  ENDIF
 ELIF <ACT.ATTR> & ATTR_MOVE_NEVER
  ADDCLILOC 3005142
 ENDIF
 ADDCLILOC 1072226,<ACT.FCOUNT>,<QVAL <ACT.WEIGHT>!=<EVAL (<ACT.WEIGHT>/10)*10>?<FVAL <ACT.WEIGHT>>:<EVAL <ACT.WEIGHT>/10>>
 RETURN 1
ENDIF

IF ( <ACT.WEIGHT> > 0 ) && !( STRMATCH(T_SPELLBOOK*,<ACT.TYPE> )
 ADDCLILOC <QVAL <ACT.WEIGHT> == 10?1072788:1072225>,<QVAL <ACT.WEIGHT>!=<EVAL (<ACT.WEIGHT>/10)*10>?<FVAL <ACT.WEIGHT>>:<EVAL <ACT.WEIGHT>/10>>
ENDIF

IF <ACT.TAG0.ITEM.GARGOYLE>
 ADDCLILOC 1111709
ELIF <ACT.TAG0.ITEM.ELVEN>
 ADDCLILOC 1075086
ENDIF

IF <ACT.TAG0.EXPANSION>
 IF <ACT.dTAG0.EXPANSION> == 8
  ADDCLILOC 1078597,High Seas
 ELIF <ACT.dTAG0.EXPANSION> == 7
  ADDCLILOC 1078597,Stygian Abyss
 ELIF <ACT.dTAG0.EXPANSION> == 6
  ADDCLILOC 1078597,Mondain's Legacy
 ELIF <ACT.dTAG0.EXPANSION> == 5
  ADDCLILOC 1078597,Samurai Empire
 ELIF <ACT.dTAG0.EXPANSION> == 4
  ADDCLILOC 1078597,Age of Shadows
 ENDIF
ENDIF

IF <ACT.TAG0.ENERGYEATER>
 ADDCLILOC 1113596,<ACT.dTAG0.ENERGYEATER>
ENDIF
IF <ACT.TAG0.POISONEATER>
 ADDCLILOC 1113595,<ACT.dTAG0.POISONEATER>
ENDIF
IF <ACT.TAG0.COLDEATER>
 ADDCLILOC 1113594,<ACT.dTAG0.COLDEATER>
ENDIF
IF <ACT.TAG0.FIREEATER>
 ADDCLILOC 1113593,<ACT.dTAG0.FIREEATER>
ENDIF
IF <ACT.TAG0.KINETICEATER>
 ADDCLILOC 1113597,<ACT.dTAG0.KINETICEATER>
ENDIF
IF <ACT.TAG0.DAMAGEEATER>
 ADDCLILOC 1113598,<ACT.dTAG0.DAMAGEEATER>
ENDIF

IF <ACT.TAG0.ARTIFACT>
 ADDCLILOC 1061078,<ACT.dTAG0.ARTIFACT>
ENDIF

IF <ACT.TAG0.BALANCED>
 IF <ACT.TYPE> == T_WEAPON_BOW
  ADDCLILOC 1072792
 ENDIF
ENDIF

IF <ACT.TAG0.VELOCITY>
 IF <ACT.TYPE> == T_WEAPON_BOW
  ADDCLILOC 1072793, <ACT.dTAG0.VELOCITY>
 ENDIF
ENDIF

F_SLAYER_CLILOC
F_SKILLBONUS_CLILOC

IF <ACT.TAG0.SPLINTERINGWEAPON>
 ADDCLILOC 1112857,<ACT.dTAG0.SPLINTERINGWEAPON>
ENDIF

for 3 <def.itemprops>
local.prop = <getargv 5 <def.itemprop_<local._for>>>
local.clil = <getargv 0 <def.itemprop_<local._for>>>
    if <local.clil> < 0
     try uid.<uid>.<local.prop>_cliloc
     serv.b @,,1 ae <name> <act.name>
    elif <local.clil> > 0
        if <act.tag0.<local.prop>>
            addcliloc <local.clil>,<act.dtag0.<local.prop>>
            //addcliloc <local.clil>,<act.dtag0.<local.prop>> <qval <src.findlayer.<act.layer>.dtag.<local.prop>>?[<DEF.BFONT_LPURPLE><src.findlayer.<act.layer>.dtag.<local.prop>><DEF.BFONT_WHITE>]:>
        endif
    endif
endfor

IF <ACT.TAG0.RESPHYSICAL>
 ADDCLILOC 1060448,<ACT.dTAG0.RESPHYSICAL>
ENDIF
IF <ACT.TAG0.RESFIRE>
 ADDCLILOC 1060447,<ACT.dTAG0.RESFIRE>
ENDIF
IF <ACT.TAG0.RESCOLD>
 ADDCLILOC 1060445,<ACT.dTAG0.RESCOLD>
ENDIF
IF <ACT.TAG0.RESPOISON>
 ADDCLILOC 1060449,<ACT.dTAG0.RESPOISON>
ENDIF
IF <ACT.TAG0.RESENERGY>
 ADDCLILOC 1060446,<ACT.dTAG0.RESENERGY>
ENDIF

IF <ACT.TAG0.MAGEARMOR>
 ADDCLILOC 1060437
ENDIF

IF <ACT.ISWEAPON>
 IF <ACT.TAG0.DAMPHYSICAL> || <EVAL 100 - (<ACT.dTAG.DAMFIRE> + <ACT.dTAG.DAMCOLD> + <ACT.dTAG.DAMPOISON> + <ACT.dTAG.DAMENERGY>)> > 0
  LOCAL.PHYSICAL <EVAL 100 - (<ACT.dTAG.DAMFIRE> + <ACT.dTAG.DAMCOLD> + <ACT.dTAG.DAMPOISON> + <ACT.dTAG.DAMENERGY>)>
  ADDCLILOC 1060403,<dLOCAL.PHYSICAL>
 ENDIF
 IF <ACT.TAG0.DAMFIRE>
  ADDCLILOC 1060405,<ACT.dTAG.DAMFIRE>
 ENDIF
 IF <ACT.TAG0.DAMCOLD>
  ADDCLILOC 1060404,<ACT.dTAG.DAMCOLD>
 ENDIF
 IF <ACT.TAG0.DAMPOISON>
  ADDCLILOC 1060406,<ACT.dTAG.DAMPOISON>
 ENDIF
 IF <ACT.TAG0.DAMENERGY>
  ADDCLILOC 1060407,<ACT.dTAG.DAMENERGY>
 ENDIF
ENDIF

IF <ACT.ISWEAPON>
 ADDCLILOC 1061168,<ACT.DAM>
 IF ( <EVAL <FVAL ((<ACT.SPEED>) - <EVAL (<ACT.SPEED>/10)*10>)>> == 2 ) || ( <EVAL <FVAL ((<ACT.SPEED>) - <EVAL (<ACT.SPEED>/10)*10>)>> == 7 )
  ADDCLILOC 1061167,<FVAL <ACT.SPEED>>5s
 ELSE
  ADDCLILOC 1061167,<FVAL <ACT.SPEED>>s
 ENDIF
ENDIF
IF <ACT.RANGE> > 1
 ADDCLILOC 1061169,<GETARGV 1 <ACT.RANGE>>
ENDIF
IF <ACT.TAG0.LOWERREQUIREMENTS>
 ADDCLILOC 1060435,<ACT.dTAG.LOWERREQUIREMENTS>
ENDIF
if (<act.reqstr> > 0) && ((<act.isweapon>) || (<act.isarmor>) || (<act.type> == t_shield) || (<act.type> == t_clothing))
IF <ACT.TAG0.LOWERREQUIREMENTS>
 LOCAL.REQSTR <EVAL <ACT.REQSTR> - ((<ACT.REQSTR>*<ACT.TAG0.LOWERREQUIREMENTS>)/100)>
 IF <dLOCAL.REQSTR> > 0
  addcliloc 1061170,<dLOCAL.REQSTR>
 ENDIF
ELSEIF <ACT.REQSTR>
 addcliloc 1061170,<ACT.REQSTR>
ENDIF
endif
if <act.isweapon>
 if (<act.layer> == 2)
  addcliloc 1061171
 elseif (<act.layer> == 1) 
  addcliloc 1061824
 endif
 if <serv.skill.<act.skill>.name> == Swordsmanship
  addcliloc 1061172
 elseif <serv.skill.<act.skill>.name> == Macefighting
  addcliloc 1061173
 elseif <serv.skill.<act.skill>.name> == Fencing
  addcliloc 1061174
 elseif <serv.skill.<act.skill>.name> == Archery
  addcliloc 1061175
 elseif <serv.skill.<act.skill>.name> == Throwing
  addcliloc 1112075
 end if
endif
if ( <act.hitpoints> > 0 ) || ( ( <act.more1l> > 0 ) && ( <act.more1h> > 0 ) && ( <act.type> == t_jewelry ) )
addcliloc 1060639,<act.more1l>,<act.more1h>
endif
if strmatch(t_spellbook*,<act.type>)
 addcliloc 1042886, <act.checkspells>
endif
IF <ACT.TAG0.FACTION>
 ADDCLILOC 1041350
 ADDCLILOC 1094805,<ACT.dTAG0.RANK>
ENDIF
IF <ACT.TAG0.LIFESPAN>
 ADDCLILOC 1072517,<ACT.dTAG0.LIFESPAN>
ENDIF
IF <ACT.BASEID> == I_PIGMENTS_OF_TOKUNO
 ADDCLILOC 1060584,<ACT.dMORE1>
ENDIF
IF <ACT.BASEID> == I_ANCIENT_URN
 ADDCLILOC 1070935,<ACT.TAG.NAME>
ENDIF
IF <ACT.BASEID> == I_HONORABLE_SWORDS
 ADDCLILOC 1070936,<ACT.TAG.NAME>
ENDIF
RETURN 1

[eof]